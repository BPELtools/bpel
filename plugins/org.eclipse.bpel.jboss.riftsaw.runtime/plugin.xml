<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.2"?>

<!--=========================================================================-->
<!-- BPEL Designer Runtime Extension Point 									 -->
<!--																		 -->
<!-- Copyright (c) 2006 University College London.							 -->
<!-- All rights reserved. This program and the accompanying materials 		 -->
<!-- are made available under the terms of the Eclipse Public License v1.0	 -->
<!-- which accompanies this distribution, and is available at				 -->
<!-- http://www.eclipse.org/legal/epl-v10.html								 -->
<!--																		 -->
<!--=========================================================================-->

<plugin>

<!--=========================================================================-->
<!-- New BPEL Project Wizard			 									 -->
<!--=========================================================================-->
   
   <extension
         point="org.eclipse.ui.newWizards">
      <wizard
            name="%NEW_JBT_BPEL_PROJECT"
            icon="icons/ctool16/new_bpelprj.gif"
            category="org.eclipse.bpel.wizards"
            project="true"
            class="org.eclipse.bpel.jboss.riftsaw.runtime.ui.wizards.NewBPELProjectWizard"
            finalPerspective="org.eclipse.bpel.ui.perspective"
            preferredPerspectives="org.eclipse.bpel.ui.perspective"
            id="org.eclipse.bpel.jboss.riftsaw.runtime.wizards.newBPELProject">
            <description>%NEW_JBT_BPEL_PROJECT_DESCRIPTION</description>
      </wizard>
   </extension>
   
  <extension point="org.eclipse.wst.common.project.facet.ui.wizardPages">
    <wizard-pages action="jbt.bpel.facet.core.install">
      <page class="org.eclipse.bpel.jboss.riftsaw.runtime.ui.wizards.BPELFacetInstallPage"/>
    </wizard-pages>
  </extension>
   
<!--=========================================================================-->
<!-- BPEL ModuleType							 							 -->
<!--=========================================================================-->   
   
   <extension point="org.eclipse.wst.server.core.moduleTypes">
      <moduleType
            id="jbt.bpel.module"
            name="%JBT_MODULE_TYPE_NAME"
            description="%JBT_MODULE_TYPE_DESCRIPTION">
      </moduleType>
   </extension>
   
<!-- The following is needed to make icons for deployable modules occur in   -->
<!-- the Add and Remove Projects wizard										 -->
   
	<extension point="org.eclipse.wst.server.ui.serverImages">
		<image
			id="org.eclipse.bpel.jboss.riftsaw.runtime.jbt.bpel.module"
			typeIds="jbt.bpel.module,bpel.module"
			icon="icons/obj16/bpelfacet.gif"/>
	</extension>
   
<!--=========================================================================-->
<!-- BPEL Facet							 									 -->
<!--=========================================================================-->

	<!--
	This facet is has been deprecated, but retained for backward compatibility
	with JBoss 5.1.0 and SOA-P 5.1 and earlier
	-->
	<extension point="org.eclipse.wst.common.project.facet.core.facets">
		
		<project-facet id="jbt.bpel.facet.core">
		  <label>%JBT_BPEL_CORE_FACET_LABEL</label>
		  <description>%JBT_BPEL_CORE_FACET_DESCRIPTION</description>
		</project-facet>
		
		<project-facet-version facet="jbt.bpel.facet.core" version="2.0">
          <group-member
               id="modules">
          </group-member>
          <constraint>
            <and>
               <conflicts group="modules"/>
            </and>
          </constraint>
        </project-facet-version>
        
		<category id="jbt.bpel.category">
		  <label>%JBT_BPEL_CORE_FACET_CATEGORY_LABEL</label>
		  <description>%JBT_BPEL_CORE_FACET_CATEGORY_DESCRIPTION</description>
		</category>
		
		<action facet="jbt.bpel.facet.core" version="2.0" type="INSTALL" id="jbt.bpel.facet.core.install">
		    <delegate class="org.eclipse.bpel.jboss.riftsaw.runtime.facets.BPELCoreFacetInstallDelegate"/>
	        <config-factory class="org.eclipse.bpel.jboss.riftsaw.runtime.facets.BPELFacetInstallDataModelProvider"/>	    
		</action>

        <action facet="jbt.bpel.facet.core" version="2.0" type="UNINSTALL" id="jbt.bpel.facet.core.uninstall">
               <delegate class="org.eclipse.bpel.jboss.riftsaw.runtime.facets.BPELCoreFacetUninstallDelegate"/>
        </action>
		
		<template id="jbt.template.bpel.core">
    		<label>%JBT_BPEL_FACET_TEMPLATE_LABEL</label>
       		<fixed facet="jbt.bpel.facet.core"/>
	   </template>
    	
	</extension>

<!--=========================================================================-->
<!-- BPEL Facet	Image					 									 -->
<!--=========================================================================-->		
			
	<extension point="org.eclipse.wst.common.project.facet.ui.images">
    	<image facet="jbt.bpel.facet.core" path="icons/obj16/bpelfacet.gif"/>
    </extension>

<!--=========================================================================-->
<!-- BPEL Virtual Component				 									 -->
<!--=========================================================================-->		

    <extension
         point="org.eclipse.wst.common.modulecore.componentimpl">
      <componentimpl
            typeID="jbt.bpel.facet.core"
            class="org.eclipse.bpel.jboss.riftsaw.runtime.facets.BPELVirtualComponent">
      </componentimpl>
   </extension>


<!--=========================================================================-->
<!-- BPEL Module Factory													 -->
<!--=========================================================================-->

	<extension
         point="org.eclipse.wst.server.core.moduleFactories">
		<moduleFactory
            projects="true"
            class="org.eclipse.bpel.jboss.riftsaw.runtime.module.BPELModuleFactoryDelegate"
            id="org.eclipse.bpel.jboss.riftsaw.runtime.module.moduleFactory">
     		<moduleType
               versions="1.1, 2.0"
               types="jbt.bpel.module">
			</moduleType>
 		</moduleFactory>
     </extension>
     
<!--=========================================================================-->
<!-- BPEL Module ArtifactAdapters											 -->
<!--=========================================================================-->
     
	<extension point="org.eclipse.wst.server.core.moduleArtifactAdapters">
		<moduleArtifactAdapter
			id="org.eclipse.bpel.jboss.riftsaw.runtime.module.artifactAdapter1"
            class="org.eclipse.bpel.jboss.riftsaw.runtime.module.BPELDeployableArtifactAdapterFactory">
			<enablement>
				<with variable="selection">
					<adapt type="org.eclipse.core.resources.IProject"/>
				</with>
			</enablement>
		</moduleArtifactAdapter>
		<moduleArtifactAdapter
			id="org.eclipse.bpel.jboss.riftsaw.runtime.module.artifactAdapter2"
            class="org.eclipse.bpel.jboss.riftsaw.runtime.module.BPELDeployableArtifactAdapterFactory">
			<enablement>
				<with variable="selection">
             		<adapt type="org.eclipse.core.resources.IFile"/>
           		</with>
         	</enablement>
      	</moduleArtifactAdapter>   
   </extension>

<!--=========================================================================-->
<!-- BPEL Runtime Adapters													 -->
<!--=========================================================================-->

	<extension point="org.eclipse.core.runtime.adapters">
		<factory
			class="org.eclipse.bpel.jboss.riftsaw.runtime.module.BPELDeployableArtifactAdapterFactory"
			adaptableType="org.eclipse.core.resources.IProject">
			<adapter type="org.eclipse.debug.ui.actions.ILaunchable"/>
        </factory>
        <factory
             class="org.eclipse.bpel.jboss.riftsaw.runtime.module.BPELDeployableArtifactAdapterFactory"
             adaptableType="org.eclipse.core.resources.IFile">
            <adapter type="org.eclipse.debug.ui.actions.ILaunchable"/>
       </factory>
   </extension>

<!--=========================================================================-->
<!-- Runtime Publishers                                                      -->
<!--=========================================================================-->
   
 <extension
       point="org.jboss.ide.eclipse.as.core.publishers">
    <publisher
          class="org.eclipse.bpel.jboss.riftsaw.runtime.module.JBossBPELPublisher"
          priority="10"
          zipDelegate="false">
    </publisher>
 </extension> 

<!--=========================================================================-->
<!-- TO MAKE PROCESSES ACTUALLY LAUNCHABLE VIA RUN ON SERVER				 -->
<!-- 																		 -->
<!-- Implement org.eclipse.wst.server.core.clients in order to specify the	 -->
<!-- the client app to be used for launching.								 -->
<!-- 																		 -->
<!-- Implement org.eclipse.wst.server.core.launchableAdapters. Might have to -->
<!-- do this in server-specific way or maybe can resuse some generic server	 -->
<!-- framework stuff or maybe can come up with some interface that would	 -->
<!-- allow us to implement in runtimes plug-in.								 -->
<!-- 																		 -->
<!-- N.B. Launching here means launching a Web service. Hence, can do this	 -->
<!-- via the corresponding WTP feature with no code at all from our end.  	 -->
<!-- 																		 -->
<!-- 																		 -->
<!-- 																		 -->
<!--=========================================================================-->

	<extension
      point="org.eclipse.ui.navigator.navigatorContent">
	   <navigatorContent
	         id="org.eclipse.bpel.jboss.riftsaw.runtime.ui.view.server.content"
	         activeByDefault="true"
	         contentProvider="org.eclipse.bpel.jboss.riftsaw.runtime.ui.view.server.BPELModuleContentProvider"
	         icon="icons/obj16/bpelfacet.gif"
	         labelProvider="org.eclipse.bpel.jboss.riftsaw.runtime.ui.view.server.BPELModuleLabelProvider"
	         name="BPEL Modules"
	         priority="highest">
	      <triggerPoints>
	         <instanceof
	               value="java.lang.Object">
	         </instanceof>
	      </triggerPoints>
	      <possibleChildren>
             <instanceof
                value="java.lang.Object">
             </instanceof>
          </possibleChildren>
	      <actionProvider
	            class="org.eclipse.bpel.jboss.riftsaw.runtime.ui.view.server.BPELModuleActionProvider"
	            id="org.eclipse.bpel.jboss.riftsaw.runtime.ui.view.server.BPELModuleActionProvider"
	            priority="highest">
			<enablement>
             <or>
                <instanceof
                      value="org.eclipse.wst.server.core.IServer">
                </instanceof>
                <instanceof
                      value="org.eclipse.wst.server.ui.internal.view.servers.ModuleServer">
                </instanceof>
                <instanceof
                      value="org.eclipse.core.resources.IWorkspaceRoot">
                </instanceof>
               <adapt type="java.util.Collection">
                  <count value="0"/>
               </adapt>
               <instanceof
                     value="org.eclipse.bpel.jboss.riftsaw.runtime.ui.view.server.BPELModuleContentProvider$BPELVersionDeployment">
               </instanceof>
             </or>
            </enablement>
	      </actionProvider>
	   </navigatorContent>
	</extension>
	<extension
	      point="org.eclipse.ui.navigator.viewer">
	   <viewerContentBinding
	         viewerId="org.eclipse.wst.server.ui.ServersView">
	      <includes>
	         <contentExtension
	               isRoot="true"
	               pattern="org.eclipse.bpel.jboss.riftsaw.runtime.ui.view.server.content">
	         </contentExtension>
	      </includes>
	   </viewerContentBinding>
	</extension>
 
 
 
<!--=========================================================================-->
<!-- JBoss Runtimes              											 -->
<!--=========================================================================-->
 
 <extension
         point="org.eclipse.wst.common.project.facet.core.runtimes">
      <runtime-component-type id="org.jboss.ide.eclipse.as.runtime.stripped.component"/>
      <runtime-component-version
            type="org.jboss.ide.eclipse.as.runtime.stripped.component"
            version="1.0"/>
      <supported>
        <runtime-component
         	id="org.jboss.ide.eclipse.as.runtime.stripped.component"
         	version="1.0"/>
       <facet id="jbt.bpel.facet.core" version="1.2,2.0"/>
     </supported>
 </extension>

   <extension
         point="org.eclipse.wst.common.project.facet.core.runtimes">
      		<runtime-component-type id="org.jboss.ide.eclipse.eap.runtime.component"/>
      		<runtime-component-version
            	type="org.jboss.ide.eclipse.eap.runtime.component"
            	version="5.0"/>
   			<supported>
        		<runtime-component
         			id="org.jboss.ide.eclipse.eap.runtime.component"
         			version="5.0"/>
                <facet id="jbt.bpel.facet.core" version="1.2,2.0"/>
     		</supported>
   </extension>
		
   <extension
         point="org.eclipse.wst.common.project.facet.core.runtimes">
      <runtime-component-type id="org.jboss.ide.eclipse.as.runtime.component"/>
      <runtime-component-version
            type="org.jboss.ide.eclipse.as.runtime.component"
            version="5.1"/>
      <runtime-component-version
            type="org.jboss.ide.eclipse.as.runtime.component"
            version="6.0"/>
      <runtime-component-version
            type="org.jboss.ide.eclipse.as.runtime.component"
            version="7.0"/>

      <supported>
        <runtime-component version="5.1"
         	id="org.jboss.ide.eclipse.as.runtime.component"/>
        <facet id="jbt.bpel.facet.core" version="1.2,2.0"/>
     </supported>

      <supported>
        <runtime-component version="6.0"
         	id="org.jboss.ide.eclipse.as.runtime.component"/>
        <facet id="bpel.facet.core" version="1.2,2.0"/>
     </supported>

      <supported>
        <runtime-component version="7.0"
         	id="org.jboss.ide.eclipse.as.runtime.component"/>
        <facet id="bpel.facet.core" version="1.2,2.0"/>
     </supported>

   </extension>

</plugin>
